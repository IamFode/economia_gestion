df
df=data.frame(c(
summary(lineal)$adj.r.squared,
summary(square)$adj.r.squared,
R2AEQ(log(Y),log(X),X,Y,1),
R2AEQ(log(Y),X,X,Y,1),
summary(nlog)$adj.r.squared
))
names(df) = "R2"
Modelos = c("Modelo Lineal","Modelo cuadrático","Modelo logarítmico","Modelo semilogarítmico","Modelo nivel-log")
df = data.frame(Modelos,df)
df
View(df)
log = lm(log(Y)~log(X))
log
```{r, fig.align="center", fig.height=2, fig.width=3, echo=FALSE, warning=FALSE}
log = lm(log(Y)~log(X))
summary(log)
lineal
lineal
# librerias
library("readxl")
library("ggplot2")
# librerias
library("readxl")
library("ggplot2")
```{r echo=FALSE}
# data
url="~/git/ciencias_sociales/economia/master/r/econometria/data/Datos_actividad_1.xlsx"
data = read_excel(url)
Y=data$Costes
X=data$Producción
lineal = lm(Y~X)
ggplot(data,aes(X,Y))+
geom_point() +
geom_smooth(method = "lm", formula = y~x,color="red") +
labs(x="Volumen de producción", y="Costes de empresa")
lineal = lm(Y~X)
cat("R2 Ajustado: ",summary(lineal)$adj.r.squared)
ggplot(data,aes(X,Y))+
geom_point() +
geom_smooth(method = "lm", formula = y~x,color="red") +
labs(x="Volumen de producción", y="Costes de empresa")
lineal
cat("R2 Ajustado: ",summary(lineal)$adj.r.squared)
nlog = lm(Y~log(X))
summary(nlog)
31.217/100
data
R2AEQ(log(Y),log(X),log(X),Y,1)
R2AEQ = function(aY,aX,ax,ay,ak){
modelo = lm(aY~aX)
teq = 0
eeq = 0
for(i in 1:length(ay)){
teq = teq + (ay[i]-mean(ay))^2
eqY = exp(modelo$coefficients[1]+modelo$coefficients[2]*aX[i])
eeq = eeq + (ay[i] - eqY)^2
}
Tk1 = length(ay)-ak-1
T1 = length(ay)-1
r2aeq = 1-(eeq/Tk1)/(teq/T1)
return(as.numeric(r2aeq))
}
R2AEQ(log(Y),log(X),log(X),Y,1)
R2AEQ(log(Y),log(X),X,Y,1)
R2AEQ(log(Y),log(X),log(X),Y,1)
R2AEQ(log(Y),log(X),X,Y,1)
# librerias
library("readxl")
library("ggplot2")
# librerias
library("readxl")
library("ggplot2")
```{r echo=FALSE}
# data
url="~/git/ciencias_sociales/economia/master/r/econometria/data/Datos_actividad_1.xlsx"
data = read_excel(url)
Y=data$Costes
X=data$Producción
# data
url="~/git/ciencias_sociales/economia/master/r/econometria/data/Datos_actividad_1.xlsx"
data = read_excel(url)
Y=data$Costes
X=data$Producción
lineal = lm(Y~X)
cat("R2 Ajustado: ",summary(lineal)$adj.r.squared)
ggplot(data,aes(X,Y))+
geom_point() +
geom_smooth(method = "lm", formula = y~x,color="red") +
labs(x="Volumen de producción", y="Costes de empresa")
### 2. Modelo Cuadrático.
```{r, fig.align="center", fig.height=2, fig.width=3, echo=FALSE}
square = lm(Y~X+I(X^2))
cat("R2 Ajustado: ",summary(square)$adj.r.squared)
ggplot(data,aes(X,Y))+
geom_point() +
geom_smooth(method = "lm", formula =  y~x+I(x^2),color="red") +
labs(x="Volumen de producción", y="Costes de empresa.")
square = lm(Y~X+I(X^2))
cat("R2 Ajustado: ",summary(square)$adj.r.squared)
ggplot(data,aes(X,Y))+
geom_point() +
geom_smooth(method = "lm", formula =  y~x+I(x^2),color="red") +
labs(x="Volumen de producción", y="Costes de empresa.")
### 3. Modelo de elasticidad constante o Modelo logarítmico.
```{r, fig.align="center", fig.height=2, fig.width=3, echo=FALSE, warning=FALSE}
log = lm(log(Y)~log(X))
cat("R2 Ajustado: ",summary(log)$adj.r.squared)
ggplot(data,aes(X,Y))+
geom_point() +
geom_smooth(method = "lm",
formula = y~x,
method.args=list(family=gaussian((link='log'))),
color="red")+
labs(x="Volumen de producción", y="Costes de empresa.")
### 4. El modelo log-nivel o modelo semilogarítmico.
```{r, fig.align="center", fig.height=2, fig.width=3, echo=FALSE}
slog = lm(log(Y)~X)
cat("R2 Ajustado: ",summary(slog)$adj.r.squared)
ggplot(data,aes(X,Y))+
geom_point() +
geom_smooth(method = "glm",
formula = y~x,
method.args=list(family=gaussian((link='log'))),
color="red")+
labs(x="Volumen de producción", y="Costes de empresa.")
### 5. El modelo nivel-log.
```{r, fig.align="center", fig.height=2, fig.width=3, echo=FALSE}
nlog = lm(Y~log(X))
cat("R2 Ajustado: ",summary(nlog)$adj.r.squared)
ggplot(data,aes(X,Y))+
geom_point() +
geom_smooth(method = "glm",
formula = y~x,
method.args=list(family=gaussian((link='log'))),
color="red")+
labs(x="Volumen de producción", y="Costes de empresa.")
Para poder comparar los modelos 3 y 4  con los modelos 1,2 y 5 pondremos los R's cuadrados de los modelos 3 y 4 en términos equivalentes. Para ello debemos aplicar la siguiente fórmula.
R2AEQ = function(aY,aX,ax,ay,ak){
modelo = lm(aY~aX)
teq = 0
eeq = 0
for(i in 1:length(ay)){
teq = teq + (ay[i]-mean(ay))^2
eqY = exp(modelo$coefficients[1]+modelo$coefficients[2]*aX[i])
eeq = eeq + (ay[i] - eqY)^2
}
Tk1 = length(ay)-ak-1
T1 = length(ay)-1
r2aeq = 1-(eeq/Tk1)/(teq/T1)
return(as.numeric(r2aeq))
}
R2AEQ(log(Y),log(X),log(X),Y,1)
R2AEQ(log(Y),log(X),X,Y,1)
# data
#url="~/git/ciencias_sociales/economia/master/r/econometria/data/Datos_actividad_1.xlsx"
url="~/git/ciencias_sociales/economia/master/r/econometria/data/Datos Supuesto 1.2.xlsx"
data = read_excel(url)
Y=data$Costes
X=data$Producción
data = read_excel(url)
data
data = read_excel(url)
attack(data)
attach(data)
Y=data$Y
X=data$X
R2AEQ = function(aY,aX,ax,ay,ak){
modelo = lm(aY~aX)
teq = 0
eeq = 0
for(i in 1:length(ay)){
teq = teq + (ay[i]-mean(ay))^2
eqY = exp(modelo$coefficients[1]+modelo$coefficients[2]*aX[i])
eeq = eeq + (ay[i] - eqY)^2
}
Tk1 = length(ay)-ak-1
T1 = length(ay)-1
r2aeq = 1-(eeq/Tk1)/(teq/T1)
return(as.numeric(r2aeq))
}
R2AEQ(log(Y),log(X),log(X),Y,1)
R2AEQ(log(Y),log(X),X,Y,1)
R2AEQ(log(Y),log(X),log(X),Y,1)
# data
#url="~/git/ciencias_sociales/economia/master/r/econometria/data/Datos_actividad_1.xlsx"
url="~/git/ciencias_sociales/economia/master/r/econometria/data/Datos Supuesto 1.2.xlsx"
data = read_excel(url)
Y=data$Y
X=data$X
R2AEQ = function(aY,aX,ax,ay,ak){
modelo = lm(aY~aX)
teq = 0
eeq = 0
for(i in 1:length(ay)){
teq = teq + (ay[i]-mean(ay))^2
eqY = exp(modelo$coefficients[1]+modelo$coefficients[2]*aX[i])
eeq = eeq + (ay[i] - eqY)^2
}
Tk1 = length(ay)-ak-1
T1 = length(ay)-1
r2aeq = 1-(eeq/Tk1)/(teq/T1)
return(as.numeric(r2aeq))
}
R2AEQ(log(Y),log(X),log(X),Y,1)
R2AEQ(log(Y),log(X),X,Y,1)
R2AEQ = function(aY,aX,ax,ay,ak){
modelo = lm(aY~aX)
teq = 0
eeq = 0
for(i in 1:length(ay)){
teq = teq + (ay[i]-mean(ay))^2
eqY = exp(modelo$coefficients[1]+modelo$coefficients[2]*ax[i])
eeq = eeq + (ay[i] - eqY)^2
}
Tk1 = length(ay)-ak-1
T1 = length(ay)-1
r2aeq = 1-(eeq/Tk1)/(teq/T1)
return(as.numeric(r2aeq))
}
R2AEQ(log(Y),log(X),log(X),Y,1)
R2AEQ(log(Y),log(X),X,Y,1)
modelo
modelo = lm(aY~aX)
R2AEQ = function(aY,aX,ax,ay,ak){
modelo = lm(aY~aX)
print(modelo)
teq = 0
eeq = 0
for(i in 1:length(ay)){
teq = teq + (ay[i]-mean(ay))^2
eqY = exp(modelo$coefficients[1]+modelo$coefficients[2]*ax[i])
eeq = eeq + (ay[i] - eqY)^2
}
Tk1 = length(ay)-ak-1
T1 = length(ay)-1
r2aeq = 1-(eeq/Tk1)/(teq/T1)
return(as.numeric(r2aeq))
}
R2AEQ(log(Y),log(X),log(X),Y,1)
################# Modelo 4 con respecto a los modelos 1,2,5 ####################
model = lm(log(Y)~X,data=data)
y = data$Y
X = data$X
x = X
k=1
scteq=0
for(i in 1:length(y)){
scteq = scteq + (y[i]-mean(y))^2
}
scteq
sceeq4 = 0
for(i in 1:length(y)){
equivY = exp(model$coefficients[1]+model$coefficients[2]*x[i])
sceeq4 = sceeq4 + ( y[i] - equivY )^2
}
tk1 = length(y)-k-1
t1 = length(y)-1
r2aeq4 = 1-(sceeq4/tk1)/(scteq/t1)
r2aeq4
################# Modelo 4 con respecto a los modelos 1,2,5 ####################
model = lm(log(Y)~X,data=data)
model
# 3. Modelo de elasticidad constante o modelo logarítmico.
model = lm(log(Y)~log(X),data=data)
model
R2AEQ(log(Y),log(X),log(X),Y,1)
R2AEQ(log(Y),log(X),X,Y,1)
# data
#url="~/git/ciencias_sociales/economia/master/r/econometria/data/Datos_actividad_1.xlsx"
url="~/git/ciencias_sociales/economia/master/r/econometria/data/Datos Supuesto 1.2.xlsx"
data = read_excel(url)
Y=data$Y
X=data$X
R2AEQ = function(aY,aX,ax,ay,ak){
modelo = lm(aY~aX)
teq = 0
eeq = 0
for(i in 1:length(ay)){
teq = teq + (ay[i]-mean(ay))^2
eqY = exp(modelo$coefficients[1]+modelo$coefficients[2]*ax[i])
eeq = eeq + (ay[i] - eqY)^2
}
Tk1 = length(ay)-ak-1
T1 = length(ay)-1
r2aeq = 1-(eeq/Tk1)/(teq/T1)
return(as.numeric(r2aeq))
}
R2AEQ(log(Y),log(X),log(X),Y,1)
R2AEQ(log(Y),log(X),X,Y,1)
R2AEQ = function(aY,aX,ax,ay,ak){
modelo = lm(aY~aX)
teq = 0
eeq = 0
for(i in 1:length(ay)){
teq = teq + (ay[i]-mean(ay))^2
eqY = exp(modelo$coefficients[1]+modelo$coefficients[2]*ax[i])
print(eqY)
eeq = eeq + (ay[i] - eqY)^2
}
Tk1 = length(ay)-ak-1
T1 = length(ay)-1
r2aeq = 1-(eeq/Tk1)/(teq/T1)
return(as.numeric(r2aeq))
}
R2AEQ(log(Y),log(X),log(X),Y,1)
R2AEQ(log(Y),log(X),X,Y,1)
X
log(X)
X
log(X)
X
log(X)
View(data)
################# Modelo 4 con respecto a los modelos 1,2,5 ####################
model = lm(log(Y)~X,data=data)
y = data$Y
X = data$X
x = X
k=1
scteq=0
for(i in 1:length(y)){
scteq = scteq + (y[i]-mean(y))^2
}
scteq
sceeq4 = 0
for(i in 1:length(y)){
equivY = exp(model$coefficients[1]+model$coefficients[2]*x[i])
sceeq4 = sceeq4 + ( y[i] - equivY )^2
}
tk1 = length(y)-k-1
t1 = length(y)-1
r2aeq4 = 1-(sceeq4/tk1)/(scteq/t1)
r2aeq4
for(i in 1:length(y)){
equivY = exp(model$coefficients[1]+model$coefficients[2]*x[i])
print(equivY)
sceeq4 = sceeq4 + ( y[i] - equivY )^2
}
tk1 = length(y)-k-1
t1 = length(y)-1
r2aeq4 = 1-(sceeq4/tk1)/(scteq/t1)
r2aeq4
################# Modelo 4 con respecto a los modelos 1,2,5 ####################
model = lm(log(Y)~X,data=data)
y = data$Y
X = data$X
x = X
k=1
scteq=0
for(i in 1:length(y)){
scteq = scteq + (y[i]-mean(y))^2
}
scteq
sceeq4 = 0
for(i in 1:length(y)){
equivY = exp(model$coefficients[1]+model$coefficients[2]*x[i])
print(equivY)
sceeq4 = sceeq4 + ( y[i] - equivY )^2
}
tk1 = length(y)-k-1
t1 = length(y)-1
r2aeq4 = 1-(sceeq4/tk1)/(scteq/t1)
r2aeq4
model
################# Modelo 4 con respecto a los modelos 1,2,5 ####################
model = lm(log(Y)~X,data=data)
model
# data
#url="~/git/ciencias_sociales/economia/master/r/econometria/data/Datos_actividad_1.xlsx"
url="~/git/ciencias_sociales/economia/master/r/econometria/data/Datos Supuesto 1.2.xlsx"
data = read_excel(url)
Y=data$Y
X=data$X
R2AEQ = function(aY,aX,ax,ay,ak){
modelo = lm(aY~aX)
teq = 0
eeq = 0
for(i in 1:length(ay)){
teq = teq + (ay[i]-mean(ay))^2
eqY = exp(modelo$coefficients[1]+modelo$coefficients[2]*ax[i])
print(eqY)
eeq = eeq + (ay[i] - eqY)^2
}
Tk1 = length(ay)-ak-1
T1 = length(ay)-1
r2aeq = 1-(eeq/Tk1)/(teq/T1)
return(as.numeric(r2aeq))
}
R2AEQ(log(Y),log(X),log(X),Y,1)
R2AEQ(log(Y),log(X),X,Y,1)
R2AEQ = function(aY,aX,ax,ay,ak){
modelo = lm(aY~aX)
print(modelo)
teq = 0
eeq = 0
for(i in 1:length(ay)){
teq = teq + (ay[i]-mean(ay))^2
eqY = exp(modelo$coefficients[1]+modelo$coefficients[2]*ax[i])
eeq = eeq + (ay[i] - eqY)^2
}
Tk1 = length(ay)-ak-1
T1 = length(ay)-1
r2aeq = 1-(eeq/Tk1)/(teq/T1)
return(as.numeric(r2aeq))
}
R2AEQ(log(Y),log(X),X,Y,1)
R2AEQ(log(Y),log(X),log(X),Y,1)
R2AEQ(log(Y),X,X,Y,1)
R2AEQ(log(Y),log(X),log(X),Y,1)
R2AEQ = function(aY,aX,ax,ay,ak){
modelo = lm(aY~aX)
teq = 0 # Suma de cuadrados del Error en Términos Equivalentes
eeq = 0 # Suma de cuadrados Totales en Términos equivalentes
for(i in 1:length(ay)){
teq = teq + (ay[i]-mean(ay))^2
eqY = exp(modelo$coefficients[1]+modelo$coefficients[2]*ax[i])
eeq = eeq + (ay[i] - eqY)^2
}
Tk1 = length(ay)-ak-1
T1 = length(ay)-1
r2aeq = 1-(eeq/Tk1)/(teq/T1)
cat("Suma de cuadrados del error en términos equivalentes: ",teq)
cat("Suma de cuadrados Totales en términos equivalentes: ",eeq)
cat("R2 Equivalente",as.numeric(r2aeq))
}
R2AEQ(log(Y),log(X),log(X),Y,1)
R2AEQ = function(aY,aX,ax,ay,ak){
modelo = lm(aY~aX)
teq = 0 # Suma de cuadrados del Error en Términos Equivalentes
eeq = 0 # Suma de cuadrados Totales en Términos equivalentes
for(i in 1:length(ay)){
teq = teq + (ay[i]-mean(ay))^2
eqY = exp(modelo$coefficients[1]+modelo$coefficients[2]*ax[i])
eeq = eeq + (ay[i] - eqY)^2
}
Tk1 = length(ay)-ak-1
T1 = length(ay)-1
r2aeq = 1-(eeq/Tk1)/(teq/T1)
cat("Suma de cuadrados del error en términos equivalentes: ",teq)
cat("Suma de cuadrados Totales en términos equivalentes: ",eeq)
cat("R2 Equivalente",as.numeric(r2aeq))
}
R2AEQ = function(aY,aX,ax,ay,ak){
modelo = lm(aY~aX)
teq = 0 # Suma de cuadrados del Error en Términos Equivalentes
eeq = 0 # Suma de cuadrados Totales en Términos equivalentes
for(i in 1:length(ay)){
teq = teq + (ay[i]-mean(ay))^2
eqY = exp(modelo$coefficients[1]+modelo$coefficients[2]*ax[i])
eeq = eeq + (ay[i] - eqY)^2
}
Tk1 = length(ay)-ak-1
T1 = length(ay)-1
r2aeq = 1-(eeq/Tk1)/(teq/T1)
cat("Suma de cuadrados del error en términos equivalentes: ",teq)
cat("Suma de cuadrados Totales en términos equivalentes: ",eeq)
cat("R2 Equivalente",as.numeric(r2aeq))
}
\vspace{.3cm}
Así,
- El R2 ajustado equivalente del modelo logarítmico es:
```{r, fig.align="center", fig.height=2, fig.width=3, echo=FALSE}
R2AEQ(log(Y),log(X),log(X),Y,1)
install.packages("readEviews")
readEviews()
install.packages("hexView")
salario = readEviews("Suposto 1.3 Modelos salarios.3Edition.wf1")
salario = readEViews("Suposto 1.3 Modelos salarios.3Edition.wf1")
library(hexView)
salario = readEViews("Suposto 1.3 Modelos salarios.3Edition.wf1")
salario = readEViews("Suposto 1.3 Modelos salarios.3Edition.wf1")
salario = readEViews("/data/Suposto 1.3 Modelos salarios.3Edition.wf1")
salario = readEViews("../data/Suposto 1.3 Modelos salarios.3Edition.wf1")
salario = readEViews("data/Suposto 1.3 Modelos salarios.3Edition.wf1")
View(salario)
salarios = lm(WAGE~EDUC,data=salario)
summary(salarios)
salarios = lm(WAGE~EDUC+EXPER+EXP,data=salario)
salarios = lm(WAGE~EDUC+EXPER+EXPER^2,data=salario)
summary(salarios)
salarios = lm(WAGE~EDUC+EXPER+I(EXPER^2),data=salario)
summary(salarios)
library(lmtest)
View(salario)
salario = readEViews("../data/Suposto 1.3 Modelos salarios.3Edition.wf1")
salarios = lm(WAGE~EDUC+EXPER+I(EXPER^2),data=salario)
summary(salarios)
library(hexView)
salario = readEViews("../data/Suposto 1.3 Modelos salarios.3Edition.wf1")
salarios = lm(WAGE~EDUC+EXPER+I(EXPER^2),data=salario)
summary(salarios)
library(hexView)
salario = readEViews("../data/Suposto 1.3 Modelos salarios.3Edition.wf1")
logWage = lm(log(WAGE)~EDUC+EXPER+I(EXPER^2)+EDUC*EXPER)
logWage = lm(log(WAGE)~EDUC+EXPER+I(EXPER^2)+EDUC*EXPER,data=salario)
summary(logWage)
logWage = lm(log(WAGE)~EDUC+EXPER+I(EXPER^2)+I(EDUC*EXPER),data=salario)
summary(logWage)
logWage = lm(log(WAGE)~EDUC+EXPER+I(EXPER^2)+EDUC*EXPER,data=salario)
summary(logWage)
summary(logWage)
names(logWage$coefficients) = c("EDUC","EXPER","EXPER^2","EDUC*EXPER")
summary(logWage)
names(logWage$coefficients) = c("LogWAGE","EDUC","EXPER","EXPER^2","EDUC*EXPER")
summary(logWage)
names(logWage$coefficients) = c("ln(WAGE)","EDUC","EXPER","EXPER^2","EDUC*EXPER")
summary(logWage)
View(salario)
View(logWage)
View(logWage)
