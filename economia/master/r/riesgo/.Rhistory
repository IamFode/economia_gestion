set.seed(2)
aleatorioN = rnorm(length(x),0,1)
precio = last+last*(mediaAnual*delta+deAnual*sqrt(delta)*aleatorioN)
print(precio)
}
simMonteCarlo(cartera$ibex,252)
# SIMULACIÓN MONTE CARLO
simMonteCarlo = function(x,dias){
rentabilidad = rentabActivo(x)
deAnual = sqrt(dias)*sd(rentabilidad)
mediaAnual = 252*mean(rentabilidad)
delta = 1/dias
last = tail(x,n=1)
set.seed(1)
aleatorioN = rnorm(length(x),0,1)
precio = last+last*(mediaAnual*delta+deAnual*sqrt(delta)*aleatorioN)
rent = log(precio/last)
print(rent)
}
simMonteCarlo(cartera$ibex,252)
# SIMULACIÓN MONTE CARLO
simMonteCarlo = function(x,dias,prob){
rentabilidad = rentabActivo(x)
deAnual = sqrt(dias)*sd(rentabilidad)
mediaAnual = 252*mean(rentabilidad)
delta = 1/dias
last = tail(x,n=1)
set.seed(1)
aleatorioN = rnorm(length(x),0,1)
precio = last+last*(mediaAnual*delta+deAnual*sqrt(delta)*aleatorioN)
rent = log(precio/last)
return(percentil(rent,prob))
}
simMonteCarlo(cartera$ibex,252,0.05)
# SIMULACIÓN MONTE CARLO
simMonteCarlo = function(x,dias,prob){
rentabilidad = rentabActivo(x)
deAnual = sqrt(dias)*sd(rentabilidad)
mediaAnual = 252*mean(rentabilidad)
delta = 1/dias
last = tail(x,n=1)
set.seed(1)
aleatorioN = rnorm(length(x),0,1)
precio = last+last*(mediaAnual*delta+deAnual*sqrt(delta)*aleatorioN)
rent = log(precio/last)
return(quantile(rent,prob))
}
simMonteCarlo(cartera$ibex,252,0.05)
# SIMULACIÓN MONTE CARLO
simMonteCarlo = function(x,dias,prob){
rentabilidad = rentabActivo(x)
deAnual = sqrt(dias)*sd(rentabilidad)
mediaAnual = 252*mean(rentabilidad)
delta = 1/dias
last = tail(x,n=1)
set.seed(1)
aleatorioN = rnorm(length(x),0,1)
precio = last+last*(mediaAnual*delta+deAnual*sqrt(delta)*aleatorioN)
rent = log(precio/last)
return(as.numeric(quantile(rent,prob)))
}
simMonteCarlo(cartera$ibex,252,0.05)
# SIMULACIÓN HISTORICA
simHistorica = function(x,prob){
res = diff(x, lag = 1)
last = tail(x,n=1)
Var = c()
for(i in res){
Var = c(Var,last+i)
}
rent = c()
for(i in Var){
rent = c(rent,log(i/last))
}
VaR = unname(quantile(rent,probs=prob))
ES = ES(x,prob)
result = cbind(VaR,ES)
return(result)
}
simHistorica(cartera$ibex,0.05)
simHistorica(cartera$ibex,0.05)
# EXPECTED SHORTFAIL (ES)
ES = function(x,prob){
rentabilidad = rentabActivo(x)
VarEmpirico=quantile(rentabilidad,probs = prob)
suma = sum(rentabilidad[rentabilidad<=VarEmpirico])
contar = length(rentabilidad[rentabilidad<=VarEmpirico])
return(suma/contar)
}
# SIMULACIÓN HISTORICA
simHistorica = function(x,prob){
res = diff(x, lag = 1)
last = tail(x,n=1)
Var = c()
for(i in res){
Var = c(Var,last+i)
}
rent = c()
for(i in Var){
rent = c(rent,log(i/last))
}
VaR = unname(quantile(rent,probs=prob))
ES = ES(x,prob)
result = cbind(VaR,ES)
return(result)
}
simHistorica(cartera$ibex,0.05)
# EXPECTED SHORTFAIL (ES)
ES = function(x,prob){
rentabilidad = rentabActivo(x)
VarEmpirico=quantile(rentabilidad,probs = prob,type=7)
suma = sum(rentabilidad[rentabilidad<=VarEmpirico])
contar = length(rentabilidad[rentabilidad<=VarEmpirico])
return(suma/contar)
}
ES(cartera$ibex,0.05)
# EXPECTED SHORTFAIL (ES)
ES = function(x,prob){
rentabilidad = rentabActivo(x)
print(rentabilidad)
VarEmpirico=quantile(rentabilidad,probs = prob,type=7)
suma = sum(rentabilidad[rentabilidad<=VarEmpirico])
contar = length(rentabilidad[rentabilidad<=VarEmpirico])
return(suma/contar)
}
ES(cartera$ibex,0.05)
# EXPECTED SHORTFAIL (ES)
ES = function(x,prob){
rentabilidad = rentabActivo(x)
VarEmpirico=quantile(rentabilidad,probs = prob,type=7)
print(VarEmpirico)
suma = sum(rentabilidad[rentabilidad<=VarEmpirico])
contar = length(rentabilidad[rentabilidad<=VarEmpirico])
return(suma/contar)
}
ES(cartera$ibex,0.05)
# EXPECTED SHORTFAIL (ES)
ES = function(x,prob){
rentabilidad = rentabActivo(x)
VarEmpirico=quantile(rentabilidad,probs = prob,type=6)
print(VarEmpirico)
suma = sum(rentabilidad[rentabilidad<=VarEmpirico])
contar = length(rentabilidad[rentabilidad<=VarEmpirico])
return(suma/contar)
}
ES(cartera$ibex,0.05)
# SIMULACIÓN HISTORICA
simHistorica = function(x,prob){
res = diff(x, lag = 1)
last = tail(x,n=1)
Var = c()
for(i in res){
Var = c(Var,last+i)
}
rent = c()
for(i in Var){
rent = c(rent,log(i/last))
}
VaR = unname(quantile(rent,probs=prob))
quantil = quantile(rent,0.05)
print(quantil)
ES = sum(rent[rent<=VaR])/length(rent[rent<=VaR])
result = cbind(VaR,ES)
return(result)
}
simHistorica(cartera$ibex,0.05)
# SIMULACIÓN HISTORICA
simHistorica = function(x,prob){
res = diff(x, lag = 1)
last = tail(x,n=1)
Var = c()
for(i in res){
Var = c(Var,last+i)
}
rent = c()
for(i in Var){
rent = c(rent,log(i/last))
}
VaR = unname(quantile(rent,probs=prob))
quantil = quantile(rent,0.05,type=6)
print(quantil)
ES = sum(rent[rent<=VaR])/length(rent[rent<=VaR])
result = cbind(VaR,ES)
return(result)
}
simHistorica(cartera$ibex,0.05)
# SIMULACIÓN HISTORICA
simHistorica = function(x,prob){
res = diff(x, lag = 1)
last = tail(x,n=1)
Var = c()
for(i in res){
Var = c(Var,last+i)
}
rent = c()
for(i in Var){
rent = c(rent,log(i/last))
}
VaR = unname(quantile(rent,probs=prob))
quantil = quantile(rent,0.05,type=6)
print(quantil)
ES = sum(rent[rent<=VaR])/length(rent[rent<=VaR])
result = cbind(VaR,ES)
return(result)
}
simHistorica(cartera$ibex,0.05)
simMonteCarlo(cartera$santander,252,0.05)
# SIMULACIÓN MONTE CARLO
simMonteCarlo = function(x,dias,prob){
rentabilidad = rentabActivo(x)
deAnual = sqrt(dias)*sd(rentabilidad)
mediaAnual = 252*mean(rentabilidad)
delta = 1/dias
last = tail(x,n=1)
set.seed(1)
aleatorioN = rnorm(length(x),0,1)
precio = last+last*(mediaAnual*delta+deAnual*sqrt(delta)*aleatorioN)
rent = log(precio/last)
VaR = quantile(rent,prob)
ES = 1
}
simMonteCarlo(cartera$santander,252,0.05)
simMonteCarlo(cartera$ibex,252,0.05)
# SIMULACIÓN HISTORICA
simHistorica = function(x,prob){
res = diff(x, lag = 1)
last = tail(x,n=1)
Var = c()
for(i in res){
Var = c(Var,last+i)
}
rent = c()
for(i in Var){
rent = c(rent,log(i/last))
}
VaR = unname(quantile(rent,probs=prob))
quantil = quantile(rent,0.05,type=6)
print(quantil)
ES = sum(rent[rent<=VaR])/length(rent[rent<=VaR])
result = cbind(VaR,ES)
return(result)
}
simHistorica(cartera$santander,0.05)
# SIMULACIÓN HISTORICA
simHistorica = function(x,prob){
res = diff(x, lag = 1)
last = tail(x,n=1)
Var = c()
for(i in res){
Var = c(Var,last+i)
}
rent = c()
for(i in Var){
rent = c(rent,log(i/last))
}
VaR = unname(quantile(rent,probs=prob))
quantil = quantile(Var,0.05,type=6)
print(quantil)
ES = sum(rent[rent<=VaR])/length(rent[rent<=VaR])
result = cbind(VaR,ES)
return(result)
}
simHistorica(cartera$santander,0.05)
# SIMULACIÓN HISTORICA
simHistorica = function(x,prob){
res = diff(x, lag = 1)
last = tail(x,n=1)
Var = c()
for(i in res){
Var = c(Var,last+i)
}
rent = c()
for(i in Var){
rent = c(rent,log(i/last))
}
VaR = unname(quantile(rent,probs=prob))
ES = sum(rent[rent<=VaR])/length(rent[rent<=VaR])
result = cbind(VaR,ES)
return(result)
}
simHistorica(cartera$santander,0.05)
# SIMULACIÓN HISTORICA
simHistorica = function(x,prob){
res = diff(x, lag = 1)
last = tail(x,n=1)
Var = c()
for(i in res){
Var = c(Var,last+i)
}
rent = c()
for(i in Var){
rent = c(rent,log(i/last))
}
VaR = unname(quantile(rent,probs=prob))
ES = sum(rent[rent<=VaR])/length(rent[rent<=VaR])
result = cbind(VaR,ES)
return(result)
}
simHistorica(cartera$ibex,0.05)
# EXPECTED SHORTFAIL (ES)
ES = function(x,prob){
rentabilidad = rentabActivo(x)
#VarEmpirico=quantile(rentabilidad,probs = prob,type=6)
VarEmpirico=VaR(x,prob)
print(VarEmpirico)
suma = sum(rentabilidad[rentabilidad<=VarEmpirico])
contar = length(rentabilidad[rentabilidad<=VarEmpirico])
return(suma/contar)
}
ES(cartera$ibex,0.05)
# EXPECTED SHORTFAIL (ES)
ES = function(x,prob){
rentabilidad = rentabActivo(x)
#VarEmpirico=quantile(rentabilidad,probs = prob,type=6)
VarEmpirico=VaR(x,prob)
print(VarEmpirico)
suma = sum(rentabilidad[rentabilidad<=VarEmpirico])
contar = length(rentabilidad[rentabilidad<=VarEmpirico])
return(suma/contar)
}
ES(cartera$ibex,0.05)
# EXPECTED SHORTFAIL (ES)
ES = function(x,prob){
rentabilidad = rentabActivo(x)
#VarEmpirico=quantile(rentabilidad,probs = prob,type=6)
VarEmpirico=VaR(rentabilidad,prob)
print(VarEmpirico)
suma = sum(rentabilidad[rentabilidad<=VarEmpirico])
contar = length(rentabilidad[rentabilidad<=VarEmpirico])
return(suma/contar)
}
ES(cartera$ibex,0.05)
# EXPECTED SHORTFAIL (ES)
ES = function(x,prob){
rentabilidad = rentabActivo(x)
VarEmpirico=quantile(rentabilidad,probs = prob,type=6)
print(VarEmpirico)
suma = sum(rentabilidad[rentabilidad<=VarEmpirico])
contar = length(rentabilidad[rentabilidad<=VarEmpirico])
return(suma/contar)
}
ES(cartera$ibex,0.05)
View(ES)
# SIMULACIÓN MONTE CARLO
simMonteCarlo = function(x,dias,prob){
rentabilidad = rentabActivo(x)
deAnual = sqrt(dias)*sd(rentabilidad)
mediaAnual = 252*mean(rentabilidad)
delta = 1/dias
last = tail(x,n=1)
set.seed(1)
aleatorioN = rnorm(length(x),0,1)
precio = last+last*(mediaAnual*delta+deAnual*sqrt(delta)*aleatorioN)
rent = log(precio/last)
VaR = quantile(rent,prob)
ES = sum(rent[rent<=VaR])/length(rent[rent<=VaR])
}
simMonteCarlo(cartera$ibex,252,0.05)
# SIMULACIÓN MONTE CARLO
simMonteCarlo = function(x,dias,prob){
rentabilidad = rentabActivo(x)
deAnual = sqrt(dias)*sd(rentabilidad)
mediaAnual = 252*mean(rentabilidad)
delta = 1/dias
last = tail(x,n=1)
set.seed(1)
aleatorioN = rnorm(length(x),0,1)
precio = last+last*(mediaAnual*delta+deAnual*sqrt(delta)*aleatorioN)
rent = log(precio/last)
VaR = quantile(rent,prob)
ES = sum(rent[rent<=VaR])/length(rent[rent<=VaR])
result = cbind(VaR,ES)
return(result)
}
simMonteCarlo(cartera$ibex,252,0.05)
# SIMULACIÓN MONTE CARLO
simMonteCarlo = function(x,dias,prob){
rentabilidad = rentabActivo(x)
deAnual = sqrt(dias)*sd(rentabilidad)
mediaAnual = 252*mean(rentabilidad)
delta = 1/dias
last = tail(x,n=1)
set.seed(1)
aleatorioN = rnorm(length(x),0,1)
precio = last+last*(mediaAnual*delta+deAnual*sqrt(delta)*aleatorioN)
rent = log(precio/last)
VaR = quantile(rent,prob)
ES = sum(rent[rent<=VaR])/length(rent[rent<=VaR])
result = cbind(VaR,ES)
return(result)
}
simMonteCarlo(cartera$ibex,252,0.05)
# SIMULACIÓN MONTE CARLO
simMonteCarlo = function(x,dias,prob){
rentabilidad = rentabActivo(x)
deAnual = sqrt(dias)*sd(rentabilidad)
mediaAnual = 252*mean(rentabilidad)
delta = 1/dias
last = tail(x,n=1)
set.seed(1000)
aleatorioN = rnorm(length(x),0,1)
precio = last+last*(mediaAnual*delta+deAnual*sqrt(delta)*aleatorioN)
rent = log(precio/last)
VaR = quantile(rent,prob)
ES = sum(rent[rent<=VaR])/length(rent[rent<=VaR])
result = cbind(VaR,ES)
return(result)
}
# SIMULACIÓN MONTE CARLO
simMonteCarlo = function(x,dias,prob){
rentabilidad = rentabActivo(x)
deAnual = sqrt(dias)*sd(rentabilidad)
mediaAnual = 252*mean(rentabilidad)
delta = 1/dias
last = tail(x,n=1)
set.seed(1000)
aleatorioN = rnorm(length(x),0,1)
precio = last+last*(mediaAnual*delta+deAnual*sqrt(delta)*aleatorioN)
rent = log(precio/last)
VaR = quantile(rent,prob)
ES = sum(rent[rent<=VaR])/length(rent[rent<=VaR])
result = cbind(VaR,ES)
return(result)
}
simMonteCarlo(cartera$ibex,252,0.05)
simMonteCarlo(cartera$ibex,252,0.05)
# SIMULACIÓN MONTE CARLO
simMonteCarlo = function(x,dias,prob){
rentabilidad = rentabactivo(x)
deanual = sqrt(dias)*sd(rentabilidad)
mediaanual = 252*mean(rentabilidad)
delta = 1/dias
last = tail(x,n=1)
set.seed(1000)
aleatorion = rnorm(length(x),0,1)
precio = last+last*(mediaanual*delta+deanual*sqrt(delta)*aleatorion)
rent = log(precio/last)
var = quantile(rent,prob)
es = sum(rent[rent<=var])/length(rent[rent<=var])
result = cbind(var,es)
return(result)
}
simMonteCarlo(cartera$ibex,252,0.05)
simMonteCarlo(cartera$ibex,252,0.05)
# SIMULACIÓN MONTE CARLO
simMonteCarlo = function(x,dias,prob){
rentabilidad = rentAbactivo(x)
deanual = sqrt(dias)*sd(rentabilidad)
mediaanual = 252*mean(rentabilidad)
delta = 1/dias
last = tail(x,n=1)
set.seed(1000)
aleatorion = rnorm(length(x),0,1)
precio = last+last*(mediaanual*delta+deanual*sqrt(delta)*aleatorion)
rent = log(precio/last)
var = quantile(rent,prob)
es = sum(rent[rent<=var])/length(rent[rent<=var])
result = cbind(var,es)
return(result)
}
simMonteCarlo(cartera$ibex,252,0.05)
# SIMULACIÓN MONTE CARLO
simMonteCarlo = function(x,dias,prob){
rentabilidad = rentabActivo(x)
deanual = sqrt(dias)*sd(rentabilidad)
mediaanual = 252*mean(rentabilidad)
delta = 1/dias
last = tail(x,n=1)
set.seed(1000)
aleatorion = rnorm(length(x),0,1)
precio = last+last*(mediaanual*delta+deanual*sqrt(delta)*aleatorion)
rent = log(precio/last)
var = quantile(rent,prob)
es = sum(rent[rent<=var])/length(rent[rent<=var])
result = cbind(var,es)
return(result)
}
simMonteCarlo(cartera$ibex,252,0.05)
# SIMULACIÓN MONTE CARLO
simMonteCarlo = function(x,dias,prob){
rentabilidad = rentabActivo(x)
deanual = sqrt(dias)*sd(rentabilidad)
mediaanual = 252*mean(rentabilidad)
delta = 1/dias
last = tail(x,n=1)
set.seed(1000)
aleatorion = rnorm(length(x),0,1)
precio = last+last*(mediaanual*delta+deanual*sqrt(delta)*aleatorion)
rent = log(precio/last)
Var = quantile(rent,prob)
ES = sum(rent[rent<=var])/length(rent[rent<=var])
result = cbind(Var,ES)
return(result)
}
simMonteCarlo(cartera$ibex,252,0.05)
# SIMULACIÓN MONTE CARLO
simMonteCarlo = function(x,dias,prob){
rentabilidad = rentabActivo(x)
deanual = sqrt(dias)*sd(rentabilidad)
mediaanual = 252*mean(rentabilidad)
delta = 1/dias
last = tail(x,n=1)
set.seed(1000)
aleatorion = rnorm(length(x),0,1)
precio = last+last*(mediaanual*delta+deanual*sqrt(delta)*aleatorion)
rent = log(precio/last)
Var = quantile(rent,prob)
ES = sum(rent[rent<=Var])/length(rent[rent<=Var])
result = cbind(Var,ES)
return(result)
}
simMonteCarlo(cartera$ibex,252,0.05)
