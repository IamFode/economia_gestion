rentabilidades = rentabActivo(rentab)
matriz_cor <- cor(rentabilidades)
cholesk <- chol(matriz_cor)
aleatorio <- matrix(rnorm(nrow(rentab) * ncol(rentab)), nrow = nrow(rentab))
epsilons = aleatorio %*% cholesk
last = tail(rentab,n=1)
mediasanuales = dias*colMeans(rentabilidades)
delta = 1/dias
deAnuales = sqrt(dias)*apply(rentabilidades,2,sd)
print(class(deAnuales))
#activox = lastx+(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
uno = sqrt(delta)*epsilons
dos = t(apply(uno, 1, function(x) x * deAnuales))
tres = mediasanuales*delta
cuatro = t(apply(dos, 1, function(x) x + tres))
print(class(deAnuales))
prin()
print(class(last))
secFormula <- mediasanuales * delta + deAnuales * sqrt(delta) * epsilons
activos <- t(apply(secFormula, 1, function(x) last + last * x))
rentabilidadActivos <- rentabActivo(activos)
correlacion <- cor(rentabilidadActivos)
}
choleski(cartera$ibex,cartera$santander,dias=252)
# MATRIZ DE CHOLESKI PARA MONTECARLO GENERALIZADO
choleski <- function(dias,...) {
set.seed(2000)
rentab <- as.matrix(data.frame(...))
rentabilidades = rentabActivo(rentab)
matriz_cor <- cor(rentabilidades)
cholesk <- chol(matriz_cor)
aleatorio <- matrix(rnorm(nrow(rentab) * ncol(rentab)), nrow = nrow(rentab))
epsilons = aleatorio %*% cholesk
last = tail(rentab,n=1)
mediasanuales = dias*colMeans(rentabilidades)
delta = 1/dias
deAnuales = sqrt(dias)*apply(rentabilidades,2,sd)
print(class(deAnuales))
#activox = lastx+(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
uno = sqrt(delta)*epsilons
dos = t(apply(uno, 1, function(x) x * deAnuales))
tres = mediasanuales*delta
cuatro = t(apply(dos, 1, function(x) x + tres))
print(class(deAnuales))
print(class(last))
secFormula <- mediasanuales * delta + deAnuales * sqrt(delta) * epsilons
activos <- t(apply(secFormula, 1, function(x) last + last * x))
rentabilidadActivos <- rentabActivo(activos)
correlacion <- cor(rentabilidadActivos)
}
choleski(cartera$ibex,cartera$santander,dias=252)
# MATRIZ DE CHOLESKI PARA MONTECARLO GENERALIZADO
choleski <- function(dias,...) {
set.seed(2000)
rentab <- as.matrix(data.frame(...))
rentabilidades = rentabActivo(rentab)
matriz_cor <- cor(rentabilidades)
cholesk <- chol(matriz_cor)
aleatorio <- matrix(rnorm(nrow(rentab) * ncol(rentab)), nrow = nrow(rentab))
epsilons = aleatorio %*% cholesk
last = tail(rentab,n=1)
mediasanuales = dias*colMeans(rentabilidades)
delta = 1/dias
deAnuales = sqrt(dias)*apply(rentabilidades,2,sd)
print(class(deAnuales))
#activox = lastx+(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
uno = sqrt(delta)*epsilons
dos = t(apply(uno, 1, function(x) x * deAnuales))
tres = mediasanuales*delta
cuatro = t(apply(dos, 1, function(x) x + tres))
print(class(deAnuales))
print(class(last))
secFormula <- mediasanuales * delta + deAnuales * sqrt(delta) * epsilons
activos <- t(apply(secFormula, 1, function(x) last + last * x))
rentabilidadActivos <- rentabActivo(activos)
correlacion <- cor(rentabilidadActivos)
}
choleski(cartera$ibex,cartera$santander,dias=252)
# MATRIZ DE CHOLESKI PARA MONTECARLO GENERALIZADO
choleski <- function(dias,...) {
set.seed(2000)
rentab <- as.matrix(data.frame(...))
rentabilidades = rentabActivo(rentab)
matriz_cor <- cor(rentabilidades)
cholesk <- chol(matriz_cor)
aleatorio <- matrix(rnorm(nrow(rentab) * ncol(rentab)), nrow = nrow(rentab))
epsilons = aleatorio %*% cholesk
last = tail(rentab,n=1)
mediasanuales = dias*colMeans(rentabilidades)
delta = 1/dias
deAnuales = sqrt(dias)*apply(rentabilidades,2,sd)
print(class(deAnuales))
#activox = lastx+(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
uno = sqrt(delta)*epsilons
dos = t(apply(uno, 1, function(x) x * deAnuales))
tres = mediasanuales*delta
cuatro = t(apply(dos, 1, function(x) x + tres))
cinco = t(apply(cuatro, 1, function(x) x * last))
print(cinco)
secFormula <- mediasanuales * delta + deAnuales * sqrt(delta) * epsilons
activos <- t(apply(secFormula, 1, function(x) last + last * x))
rentabilidadActivos <- rentabActivo(activos)
correlacion <- cor(rentabilidadActivos)
}
choleski(cartera$ibex,cartera$santander,dias=252)
simMonteCarlo2(cartera$ibex,cartera$santander,252)
# SIMULACIÓN MONTE CARLO (dos variables)
simMonteCarlo2 = function(x,y,dias){
rentabilidadx = rentabActivo(x)
rentabilidady = rentabActivo(y)
deanualx = sqrt(dias)*sd(rentabilidadx)
deanualy = sqrt(dias)*sd(rentabilidady)
mediaanualx = dias*mean(rentabilidadx)
mediaanualy = dias*mean(rentabilidady)
delta = 1/dias
lastx = tail(x,n=1)
lasty = tail(y,n=1)
set.seed(2000)
epsilon1 = rnorm(length(x),0,1)
aleatorioy = rnorm(length(y),0,1)
#preciox = lastx+lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1)
#precioy = lasty+lasty*(mediaanualy*delta+deanualy*sqrt(delta)*aleatorioy)
corr = cor(rentabilidadx,rentabilidady)
epsilon2=corr*epsilon1+sqrt(1-corr*corr)*aleatorioy
activox = lastx+(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
print(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
activoy = lasty*(lasty*(mediaanualy*delta+deanualy*sqrt(delta)*epsilon2))
print(lasty*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
resx = rentabActivo(activox)
resy = rentabActivo(activoy)
corrxy = cor(resx,resy)
return(corrxy)
}
# MATRIZ DE CHOLESKI PARA MONTECARLO GENERALIZADO
choleski <- function(dias,...) {
set.seed(2000)
rentab <- as.matrix(data.frame(...))
rentabilidades = rentabActivo(rentab)
matriz_cor <- cor(rentabilidades)
cholesk <- chol(matriz_cor)
aleatorio <- matrix(rnorm(nrow(rentab) * ncol(rentab)), nrow = nrow(rentab))
epsilons = aleatorio %*% cholesk
last = tail(rentab,n=1)
mediasanuales = dias*colMeans(rentabilidades)
delta = 1/dias
deAnuales = sqrt(dias)*apply(rentabilidades,2,sd)
print(class(deAnuales))
#activox = lastx+(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
uno = sqrt(delta)*epsilons
dos = t(apply(uno, 1, function(x) x * deAnuales))
tres = mediasanuales*delta
cuatro = t(apply(dos, 1, function(x) x + tres))
cinco = t(apply(cuatro, 1, function(x) x * last))
print(cinco)
secFormula <- mediasanuales * delta + deAnuales * sqrt(delta) * epsilons
activos <- t(apply(secFormula, 1, function(x) last + last * x))
rentabilidadActivos <- rentabActivo(activos)
correlacion <- cor(rentabilidadActivos)
}
simMonteCarlo2(cartera$ibex,cartera$santander,252)
choleski(cartera$ibex,cartera$santander,dias=252)
# SIMULACIÓN MONTE CARLO (dos variables)
simMonteCarlo2 = function(x,y,dias){
rentabilidadx = rentabActivo(x)
rentabilidady = rentabActivo(y)
deanualx = sqrt(dias)*sd(rentabilidadx)
deanualy = sqrt(dias)*sd(rentabilidady)
mediaanualx = dias*mean(rentabilidadx)
mediaanualy = dias*mean(rentabilidady)
delta = 1/dias
lastx = tail(x,n=1)
lasty = tail(y,n=1)
set.seed(2000)
epsilon1 = rnorm(length(x),0,1)
aleatorioy = rnorm(length(y),0,1)
#preciox = lastx+lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1)
#precioy = lasty+lasty*(mediaanualy*delta+deanualy*sqrt(delta)*aleatorioy)
corr = cor(rentabilidadx,rentabilidady)
epsilon2=corr*epsilon1+sqrt(1-corr*corr)*aleatorioy
activox = lastx+(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
print(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
activoy = lasty*(lasty*(mediaanualy*delta+deanualy*sqrt(delta)*epsilon2))
print(lasty*(mediaanualy*delta+deanualy*sqrt(delta)*epsilon1))
resx = rentabActivo(activox)
resy = rentabActivo(activoy)
corrxy = cor(resx,resy)
return(corrxy)
}
# MATRIZ DE CHOLESKI PARA MONTECARLO GENERALIZADO
choleski <- function(dias,...) {
set.seed(2000)
rentab <- as.matrix(data.frame(...))
rentabilidades = rentabActivo(rentab)
matriz_cor <- cor(rentabilidades)
cholesk <- chol(matriz_cor)
aleatorio <- matrix(rnorm(nrow(rentab) * ncol(rentab)), nrow = nrow(rentab))
epsilons = aleatorio %*% cholesk
last = tail(rentab,n=1)
mediasanuales = dias*colMeans(rentabilidades)
delta = 1/dias
deAnuales = sqrt(dias)*apply(rentabilidades,2,sd)
print(class(deAnuales))
#activox = lastx+(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
uno = sqrt(delta)*epsilons
dos = t(apply(uno, 1, function(x) x * deAnuales))
tres = mediasanuales*delta
cuatro = t(apply(dos, 1, function(x) x + tres))
cinco = t(apply(cuatro, 1, function(x) x * last))
print(cinco)
secFormula <- mediasanuales * delta + deAnuales * sqrt(delta) * epsilons
activos <- t(apply(secFormula, 1, function(x) last + last * x))
rentabilidadActivos <- rentabActivo(activos)
correlacion <- cor(rentabilidadActivos)
}
choleski(cartera$ibex,cartera$santander,dias=252)
simMonteCarlo2(cartera$ibex,cartera$santander,252)
choleski(cartera$ibex,cartera$santander,dias=252)
simMonteCarlo2(cartera$ibex,cartera$santander,252)
# SIMULACIÓN MONTE CARLO (dos variables)
simMonteCarlo2 = function(x,y,dias){
rentabilidadx = rentabActivo(x)
rentabilidady = rentabActivo(y)
deanualx = sqrt(dias)*sd(rentabilidadx)
deanualy = sqrt(dias)*sd(rentabilidady)
mediaanualx = dias*mean(rentabilidadx)
mediaanualy = dias*mean(rentabilidady)
delta = 1/dias
lastx = tail(x,n=1)
lasty = tail(y,n=1)
set.seed(2000)
epsilon1 = rnorm(length(x),0,1)
aleatorioy = rnorm(length(y),0,1)
#preciox = lastx+lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1)
#precioy = lasty+lasty*(mediaanualy*delta+deanualy*sqrt(delta)*aleatorioy)
corr = cor(rentabilidadx,rentabilidady)
epsilon2=corr*epsilon1+sqrt(1-corr*corr)*aleatorioy
activox = lastx+(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
print(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
activoy = lasty*(lasty*(mediaanualy*delta+deanualy*sqrt(delta)*epsilon2))
print(lasty*(mediaanualy*delta+deanualy*sqrt(delta)*epsilon2))
resx = rentabActivo(activox)
resy = rentabActivo(activoy)
corrxy = cor(resx,resy)
return(corrxy)
}
# MATRIZ DE CHOLESKI PARA MONTECARLO GENERALIZADO
choleski <- function(dias,...) {
set.seed(2000)
rentab <- as.matrix(data.frame(...))
rentabilidades = rentabActivo(rentab)
matriz_cor <- cor(rentabilidades)
cholesk <- chol(matriz_cor)
aleatorio <- matrix(rnorm(nrow(rentab) * ncol(rentab)), nrow = nrow(rentab))
epsilons = aleatorio %*% cholesk
last = tail(rentab,n=1)
mediasanuales = dias*colMeans(rentabilidades)
delta = 1/dias
deAnuales = sqrt(dias)*apply(rentabilidades,2,sd)
print(class(deAnuales))
#activox = lastx+(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
uno = sqrt(delta)*epsilons
dos = t(apply(uno, 1, function(x) x * deAnuales))
tres = mediasanuales*delta
cuatro = t(apply(dos, 1, function(x) x + tres))
cinco = t(apply(cuatro, 1, function(x) x * last))
print(cinco)
secFormula <- mediasanuales * delta + deAnuales * sqrt(delta) * epsilons
activos <- t(apply(secFormula, 1, function(x) last + last * x))
rentabilidadActivos <- rentabActivo(activos)
correlacion <- cor(rentabilidadActivos)
}
simMonteCarlo2(cartera$ibex,cartera$santander,252)
# SIMULACIÓN MONTE CARLO (dos variables)
simMonteCarlo2 = function(x,y,dias){
rentabilidadx = rentabActivo(x)
rentabilidady = rentabActivo(y)
deanualx = sqrt(dias)*sd(rentabilidadx)
deanualy = sqrt(dias)*sd(rentabilidady)
mediaanualx = dias*mean(rentabilidadx)
mediaanualy = dias*mean(rentabilidady)
delta = 1/dias
lastx = tail(x,n=1)
lasty = tail(y,n=1)
set.seed(2000)
epsilon1 = rnorm(length(x),0,1)
aleatorioy = rnorm(length(y),0,1)
#preciox = lastx+lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1)
#precioy = lasty+lasty*(mediaanualy*delta+deanualy*sqrt(delta)*aleatorioy)
corr = cor(rentabilidadx,rentabilidady)
epsilon2=corr*epsilon1+sqrt(1-corr*corr)*aleatorioy
activox = lastx+(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
activoy = lasty+(lasty*(mediaanualy*delta+deanualy*sqrt(delta)*epsilon2))
resx = rentabActivo(activox)
resy = rentabActivo(activoy)
corrxy = cor(resx,resy)
return(corrxy)
}
# MATRIZ DE CHOLESKI PARA MONTECARLO GENERALIZADO
choleski <- function(dias,...) {
set.seed(2000)
rentab <- as.matrix(data.frame(...))
rentabilidades = rentabActivo(rentab)
matriz_cor <- cor(rentabilidades)
cholesk <- chol(matriz_cor)
aleatorio <- matrix(rnorm(nrow(rentab) * ncol(rentab)), nrow = nrow(rentab))
epsilons = aleatorio %*% cholesk
last = tail(rentab,n=1)
mediasanuales = dias*colMeans(rentabilidades)
delta = 1/dias
deAnuales = sqrt(dias)*apply(rentabilidades,2,sd)
print(class(deAnuales))
#activox = lastx+(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
uno = sqrt(delta)*epsilons
dos = t(apply(uno, 1, function(x) x * deAnuales))
tres = mediasanuales*delta
cuatro = t(apply(dos, 1, function(x) x + tres))
cinco = t(apply(cuatro, 1, function(x) x * last))
print(cinco)
secFormula <- mediasanuales * delta + deAnuales * sqrt(delta) * epsilons
activos <- t(apply(secFormula, 1, function(x) last + last * x))
rentabilidadActivos <- rentabActivo(activos)
correlacion <- cor(rentabilidadActivos)
}
simMonteCarlo2(cartera$ibex,cartera$santander,252)
# SIMULACIÓN MONTE CARLO (dos variables)
simMonteCarlo2 = function(x,y,dias){
rentabilidadx = rentabActivo(x)
rentabilidady = rentabActivo(y)
deanualx = sqrt(dias)*sd(rentabilidadx)
deanualy = sqrt(dias)*sd(rentabilidady)
mediaanualx = dias*mean(rentabilidadx)
mediaanualy = dias*mean(rentabilidady)
delta = 1/dias
lastx = tail(x,n=1)
lasty = tail(y,n=1)
set.seed(2000)
epsilon1 = rnorm(length(x),0,1)
aleatorioy = rnorm(length(y),0,1)
#preciox = lastx+lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1)
#precioy = lasty+lasty*(mediaanualy*delta+deanualy*sqrt(delta)*aleatorioy)
corr = cor(rentabilidadx,rentabilidady)
epsilon2=corr*epsilon1+sqrt(1-corr*corr)*aleatorioy
activox = lastx+(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
print(activox)
activoy = lasty+(lasty*(mediaanualy*delta+deanualy*sqrt(delta)*epsilon2))
print(activoy)
resx = rentabActivo(activox)
resy = rentabActivo(activoy)
corrxy = cor(resx,resy)
return(corrxy)
}
# MATRIZ DE CHOLESKI PARA MONTECARLO GENERALIZADO
choleski <- function(dias,...) {
set.seed(2000)
rentab <- as.matrix(data.frame(...))
rentabilidades = rentabActivo(rentab)
matriz_cor <- cor(rentabilidades)
cholesk <- chol(matriz_cor)
aleatorio <- matrix(rnorm(nrow(rentab) * ncol(rentab)), nrow = nrow(rentab))
epsilons = aleatorio %*% cholesk
last = tail(rentab,n=1)
mediasanuales = dias*colMeans(rentabilidades)
delta = 1/dias
deAnuales = sqrt(dias)*apply(rentabilidades,2,sd)
print(class(deAnuales))
#activox = lastx+(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
uno = sqrt(delta)*epsilons
dos = t(apply(uno, 1, function(x) x * deAnuales))
tres = mediasanuales*delta
cuatro = t(apply(dos, 1, function(x) x + tres))
cinco = t(apply(cuatro, 1, function(x) x * last))
print(cinco)
secFormula <- mediasanuales * delta + deAnuales * sqrt(delta) * epsilons
activos <- t(apply(secFormula, 1, function(x) last + last * x))
rentabilidadActivos <- rentabActivo(activos)
correlacion <- cor(rentabilidadActivos)
}
simMonteCarlo2(cartera$ibex,cartera$santander,252)
choleski(cartera$ibex,cartera$santander,dias=252)
# MATRIZ DE CHOLESKI PARA MONTECARLO GENERALIZADO
choleski <- function(dias,...) {
set.seed(2000)
rentab <- as.matrix(data.frame(...))
rentabilidades = rentabActivo(rentab)
matriz_cor <- cor(rentabilidades)
cholesk <- chol(matriz_cor)
aleatorio <- matrix(rnorm(nrow(rentab) * ncol(rentab)), nrow = nrow(rentab))
epsilons = aleatorio %*% cholesk
last = tail(rentab,n=1)
mediasanuales = dias*colMeans(rentabilidades)
delta = 1/dias
deAnuales = sqrt(dias)*apply(rentabilidades,2,sd)
print(class(deAnuales))
#activox = lastx+(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
uno = sqrt(delta)*epsilons
dos = t(apply(uno, 1, function(x) x * deAnuales))
tres = mediasanuales*delta
cuatro = t(apply(dos, 1, function(x) x + tres))
cinco = t(apply(cuatro, 1, function(x) x * last))
seis = t(apply(cinco, 1, function(x) x + last))
print(seis)
secFormula <- mediasanuales * delta + deAnuales * sqrt(delta) * epsilons
activos <- t(apply(secFormula, 1, function(x) last + last * x))
rentabilidadActivos <- rentabActivo(activos)
correlacion <- cor(rentabilidadActivos)
}
simMonteCarlo2(cartera$ibex,cartera$santander,252)
choleski(cartera$ibex,cartera$santander,dias=252)
simMonteCarlo2(cartera$ibex,cartera$santander,252)
# SIMULACIÓN MONTE CARLO (dos variables)
simMonteCarlo2 = function(x,y,dias){
rentabilidadx = rentabActivo(x)
rentabilidady = rentabActivo(y)
deanualx = sqrt(dias)*sd(rentabilidadx)
deanualy = sqrt(dias)*sd(rentabilidady)
mediaanualx = dias*mean(rentabilidadx)
mediaanualy = dias*mean(rentabilidady)
delta = 1/dias
lastx = tail(x,n=1)
lasty = tail(y,n=1)
set.seed(2000)
epsilon1 = rnorm(length(x),0,1)
aleatorioy = rnorm(length(y),0,1)
#preciox = lastx+lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1)
#precioy = lasty+lasty*(mediaanualy*delta+deanualy*sqrt(delta)*aleatorioy)
corr = cor(rentabilidadx,rentabilidady)
epsilon2=corr*epsilon1+sqrt(1-corr*corr)*aleatorioy
activox = lastx+(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
activoy = lasty+(lasty*(mediaanualy*delta+deanualy*sqrt(delta)*epsilon2))
resx = rentabActivo(activox)
resy = rentabActivo(activoy)
corrxy = cor(resx,resy)
return(corrxy)
}
# MATRIZ DE CHOLESKI PARA MONTECARLO GENERALIZADO
choleski <- function(dias,...) {
set.seed(2000)
rentab <- as.matrix(data.frame(...))
rentabilidades = rentabActivo(rentab)
matriz_cor <- cor(rentabilidades)
cholesk <- chol(matriz_cor)
aleatorio <- matrix(rnorm(nrow(rentab) * ncol(rentab)), nrow = nrow(rentab))
epsilons = aleatorio %*% cholesk
last = tail(rentab,n=1)
mediasanuales = dias*colMeans(rentabilidades)
delta = 1/dias
deAnuales = sqrt(dias)*apply(rentabilidades,2,sd)
print(class(deAnuales))
#activox = lastx+(lastx*(mediaanualx*delta+deanualx*sqrt(delta)*epsilon1))
uno = sqrt(delta)*epsilons
dos = t(apply(uno, 1, function(x) x * deAnuales))
tres = mediasanuales*delta
cuatro = t(apply(dos, 1, function(x) x + tres))
cinco = t(apply(cuatro, 1, function(x) x * last))
seis = t(apply(cinco, 1, function(x) x + last))
correlacion = cor(seis)
return(correlacion)
secFormula <- mediasanuales * delta + deAnuales * sqrt(delta) * epsilons
activos <- t(apply(secFormula, 1, function(x) last + last * x))
rentabilidadActivos <- rentabActivo(activos)
correlacion <- cor(rentabilidadActivos)
}
choleski(cartera$ibex,cartera$santander,dias=252)
# MATRIZ DE CHOLESKI PARA MONTECARLO GENERALIZADO
choleski <- function(dias,...) {
set.seed(2000)
rentab <- as.matrix(data.frame(...))
rentabilidades = rentabActivo(rentab)
matriz_cor <- cor(rentabilidades)
cholesk <- chol(matriz_cor)
aleatorio <- matrix(rnorm(nrow(rentab) * ncol(rentab)), nrow = nrow(rentab))
epsilons = aleatorio %*% cholesk
last = tail(rentab,n=1)
mediasanuales = dias*colMeans(rentabilidades)
delta = 1/dias
deAnuales = sqrt(dias)*apply(rentabilidades,2,sd)
print(class(deAnuales))
uno = sqrt(delta)*epsilons
dos = t(apply(uno, 1, function(x) x * deAnuales))
tres = mediasanuales*delta
cuatro = t(apply(dos, 1, function(x) x + tres))
cinco = t(apply(cuatro, 1, function(x) x * last))
seis = t(apply(cinco, 1, function(x) x + last))
correlacion = cor(seis)
return(correlacion)
}
choleski(cartera$ibex,cartera$santander,dias=252)
choleski(cartera$ibex,cartera$santander,cartera$ibex,dias=252)
# MATRIZ DE CHOLESKI PARA MONTECARLO GENERALIZADO
choleski <- function(dias,...) {
set.seed(2000)
rentab <- as.matrix(data.frame(...))
rentabilidades = rentabActivo(rentab)
matriz_cor <- cor(rentabilidades)
cholesk <- chol(matriz_cor)
aleatorio <- matrix(rnorm(nrow(rentab) * ncol(rentab)), nrow = nrow(rentab))
epsilons = aleatorio %*% cholesk
last = tail(rentab,n=1)
mediasanuales = dias*colMeans(rentabilidades)
delta = 1/dias
deAnuales = sqrt(dias)*apply(rentabilidades,2,sd)
print(class(deAnuales))
uno = sqrt(delta)*epsilons
dos = t(apply(uno, 1, function(x) x * deAnuales))
tres = mediasanuales*delta
cuatro = t(apply(dos, 1, function(x) x + tres))
cinco = t(apply(cuatro, 1, function(x) x * last))
seis = t(apply(cinco, 1, function(x) x + last))
correlacion = cor(seis)
return(correlacion)
}
choleski(cartera$ibex,cartera$santander,dias=252)
